// Memcache Plus

var Client = require("../lib/client");

var cache = new Client("prd-ec-nucleus.di6cba.0001.use1.cache.amazonaws.com:11211");
//var cache = new Client("localhost");
//var cache = new Client("nucleus.dev");
//var cache = new Client("stg.socialradar.com");
var chance = require("chance").Chance();

var iterations = 1;

var start = process.hrtime();

function fetch_from_cache() {
    if (iterations > 99) {
        var diff = process.hrtime(start);
        console.log("Finished. %d fetches in series took %d.%ds so each fetch took %dms", iterations, diff[0], diff[1], ((diff[0] + diff[1] / 1e9) * 1000) / iterations);
        process.exit();
    }
    iterations++;
    console.log("Running iteration %d", iterations);
    return cache.get(chance.word())
        .then(fetch_from_cache);
}

fetch_from_cache();


// Memcached
/*
var Memcached = require("memcached");

var cache = new Memcached("prd-ec-nucleus.di6cba.0001.use1.cache.amazonaws.com:11211");
//var cache = new Memcached("localhost:11211");
//var cache = new Client("stg.socialradar.com");
var chance = require("chance").Chance();

var iterations = 1;

var start = process.hrtime();

function fetch_from_cache() {
    if (iterations > 99) {
        var diff = process.hrtime(start);
        console.log("Finished. %d fetches in series took %d.%ds so each fetch took %dms", iterations, diff[0], diff[1], ((diff[0] + diff[1] / 1e9) * 1000) / iterations);
        process.exit();
    }
    iterations++;
    console.log("Running iteration %d", iterations);
    return cache.get(chance.word(), function(err, data) {
        fetch_from_cache();
    });
}

fetch_from_cache();
*/
